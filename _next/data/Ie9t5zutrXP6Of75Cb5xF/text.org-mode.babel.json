{"pageProps":{"metadata":{"date":"\"2021-05-19 18:54:37 +08:00\"","date_modified":"\"2021-06-04 11:11:18 +08:00\"","language":"en","source":""},"title":"The basics of org-babel","hast":{"type":"root","children":[{"type":"element","tagName":"nav","properties":{"className":"toc"},"children":[{"type":"element","tagName":"ol","properties":{"className":"toc-level toc-level-1"},"children":[{"type":"element","tagName":"li","data":{"hookArgs":[{"type":"element","tagName":"h1","properties":{"id":"functional-and-scripting-mode"},"children":[{"type":"text","value":"Functional and scripting mode"}]}]},"properties":{"className":"toc-item toc-item-h1"},"children":[{"type":"element","tagName":"a","properties":{"className":"toc-link toc-link-h1","href":"/text.org-mode.babel#functional-and-scripting-mode"},"children":[{"type":"text","value":"Functional and scripting mode"}]}]},{"type":"element","tagName":"li","data":{"hookArgs":[{"type":"element","tagName":"h1","properties":{"id":"functional-mode-values-and-passing-them-around"},"children":[{"type":"text","value":"Functional mode values and passing them around"}]}]},"properties":{"className":"toc-item toc-item-h1"},"children":[{"type":"element","tagName":"a","properties":{"className":"toc-link toc-link-h1","href":"/text.org-mode.babel#functional-mode-values-and-passing-them-around"},"children":[{"type":"text","value":"Functional mode values and passing them around"}]}]},{"type":"element","tagName":"li","data":{"hookArgs":[{"type":"element","tagName":"h1","properties":{"id":"source-code-evaluation"},"children":[{"type":"text","value":"Source code evaluation"}]}]},"properties":{"className":"toc-item toc-item-h1"},"children":[{"type":"element","tagName":"a","properties":{"className":"toc-link toc-link-h1","href":"/text.org-mode.babel#source-code-evaluation"},"children":[{"type":"text","value":"Source code evaluation"}]}]},{"type":"element","tagName":"li","data":{"hookArgs":[{"type":"element","tagName":"h1","properties":{"id":"creating-dynamic-content-with-meta-programming"},"children":[{"type":"text","value":"Creating dynamic content with meta-programming"}]}]},"properties":{"className":"toc-item toc-item-h1"},"children":[{"type":"element","tagName":"a","properties":{"className":"toc-link toc-link-h1","href":"/text.org-mode.babel#creating-dynamic-content-with-meta-programming"},"children":[{"type":"text","value":"Creating dynamic content with meta-programming"}]}]},{"type":"element","tagName":"li","data":{"hookArgs":[{"type":"element","tagName":"h1","properties":{"id":"executing-code-blocks-in-the-same-session"},"children":[{"type":"text","value":"Executing code blocks in the same session"}]}]},"properties":{"className":"toc-item toc-item-h1"},"children":[{"type":"element","tagName":"a","properties":{"className":"toc-link toc-link-h1","href":"/text.org-mode.babel#executing-code-blocks-in-the-same-session"},"children":[{"type":"text","value":"Executing code blocks in the same session"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"org-babel (see "},{"type":"element","tagName":"a","properties":{"href":"/2020-04-17-21-41-30"},"children":[{"type":"text","value":"Org mode: Babel"}]},{"type":"text","value":") is the framework that enables Org mode features for reproducible research.\nIt has a variety of applications that Org mode can do in this field so let's enumerate them.\n"}]},{"type":"element","tagName":"h1","properties":{"id":"functional-and-scripting-mode"},"children":[{"type":"text","value":"Functional and scripting mode"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Babel works in two modes: functional and scripting mode.\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Functional mode returns a value either from the last statement or the return statement.\n  The value can then be used in other source code blocks and appropriately converted into Org mode equivalents.\n  If the return value is a vector type, it will be printed as tables in Org mode which will then be rendered as a vector when used in another source code block.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Scripting mode simply prints the output.\n  Do keep in mind different languages have different ways of capturing the output.\n  "}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The default mode is in functional mode but you can change it by setting "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":":results"}]},{"type":"text","value":" header argument with the values from the "},{"type":"element","tagName":"a","properties":{"href":"https://orgmode.org/manual/Results-of-Evaluation.html"},"children":[{"type":"text","value":"collection class"}]},{"type":"text","value":".\n"}]},{"type":"element","tagName":"h1","properties":{"id":"functional-mode-values-and-passing-them-around"},"children":[{"type":"text","value":"Functional mode values and passing them around"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With functional mode, the value return will appear as an appropriate element in the Org mode buffer.\nThe following examples are in "},{"type":"element","tagName":"a","properties":{"href":"https://orgmode.org/worg/org-contrib/babel/languages/ob-doc-python.html"},"children":[{"type":"text","value":"Python"}]},{"type":"text","value":".\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Scalar values appear as strings...\n"}]},{"type":"element","tagName":"pre","properties":{"className":["src-block"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-python"]},"children":[{"type":"text","value":"return \"The quick brown fox jumps over the lazy dog.\"\n"}]}]},{"type":"element","tagName":"pre","properties":{"className":["fixed-width"]},"children":[{"type":"text","value":"The quick brown fox jumps over the lazy dog."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\n...and vector values print as tables.\n"}]},{"type":"element","tagName":"pre","properties":{"className":["src-block"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-python"]},"children":[{"type":"text","value":"return [\n    [\"Monty\", 45],\n    [\"Soup\", 54],\n    [\"Cabbages\", 63]\n]\n"}]}]},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Monty"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"45"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Soup"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"54"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Cabbages"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"63"}]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"To pass values between different code blocks, you have to give the blocks a name.\nThe previous code block was given a name "},{"type":"element","tagName":"code","properties":{"className":["inline-verbatim"]},"children":[{"type":"text","value":"data"}]},{"type":"text","value":" and passed it to the next block.\n"}]},{"type":"element","tagName":"pre","properties":{"className":["src-block"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-python"]},"children":[{"type":"text","value":"return o[0]\n"}]}]},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"Monty"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"45"}]}]}]}]},{"type":"element","tagName":"h1","properties":{"id":"source-code-evaluation"},"children":[{"type":"text","value":"Source code evaluation"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The header property for executing a source code block is "},{"type":"element","tagName":"code","properties":{"className":["inline-verbatim"]},"children":[{"type":"text","value":"eval"}]},{"type":"text","value":".\nIt can accept either the following values:\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["inline-verbatim"]},"children":[{"type":"text","value":"no"}]},{"type":"text","value":" to disable evaluation of the code block.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["inline-verbatim"]},"children":[{"type":"text","value":"query"}]},{"type":"text","value":" will prompt to enable evaluation first.\n"}]}]},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["inline-verbatim"]},"children":[{"type":"text","value":"never-export"}]},{"type":"text","value":" will not show the results in export but can still interact with it from the raw source.\n"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"By default, it will enable evaluation so you have to explicitly define it (or set it in your Emacs config).\n"}]},{"type":"element","tagName":"h1","properties":{"id":"creating-dynamic-content-with-meta-programming"},"children":[{"type":"text","value":"Creating dynamic content with meta-programming"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"With "},{"type":"element","tagName":"a","properties":{"href":"https://orgmode.org/worg/org-contrib/babel/intro.html"},"children":[{"type":"text","value":"Babel"}]},{"type":"text","value":", you can call named code blocks anywhere from blocks to inline.\nThis creates a \"function\" with Babel using different languages.\nThe following block creates "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":"init"}]},{"type":"text","value":" function with a default value for its argument.\n"}]},{"type":"element","tagName":"pre","properties":{"className":["src-block"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-python"]},"children":[{"type":"text","value":"return f\"Hello {name}\"\n"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can then call the "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":"init"}]},{"type":"text","value":" function inline with "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":"call_init[${HEADER_ARGS}](${ARGS})"}]},{"type":"text","value":" which should contain \"call"},{"type":"element","tagName":"sub","properties":{},"children":[{"type":"text","value":"init"}]},{"type":"text","value":"[:results raw]() Hello world\".\nFor blocks, you can use the "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":"#+call"}]},{"type":"text","value":" block with a similar syntax to inline functions â€” i.e., "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":"#+call: init[${HEADER_ARGS}](${ARGS})"}]},{"type":"text","value":".\n"}]},{"type":"element","tagName":"pre","properties":{"className":["fixed-width"]},"children":[{"type":"text","value":"Hello world"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\nYou can also use it inside of code blocks with "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":"<<init>>"}]},{"type":"text","value":" which makes it perfect for code blocks templates like configuring paper output for Lilypond blocks.\nThough, you have to set "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":":noweb yes"}]},{"type":"text","value":" in the header arguments or configure it in "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":"org-babel-default-header-args"}]},{"type":"text","value":" as one of the default.\n"}]},{"type":"element","tagName":"pre","properties":{"className":["src-block"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-shell"]},"children":[{"type":"text","value":"echo -n <<init(name=\"Canavan\")>>\n"}]}]},{"type":"element","tagName":"pre","properties":{"className":["fixed-width"]},"children":[{"type":"text","value":"Hello Canavan"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\nBabel functions are commonly used for inserting dynamic values.\nVery helpful in reducing places you need to edit (not to mention less prone to errors).\n"}]},{"type":"element","tagName":"h1","properties":{"id":"executing-code-blocks-in-the-same-session"},"children":[{"type":"text","value":"Executing code blocks in the same session"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Each of the source code block runs on an individual session.\nHowever, you can connect source code blocks in the same session with "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":":session <SESSION NAME>"}]},{"type":"text","value":".\nThis allows you to cut code blocks and add more detailed explanations for them.\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let's start with a simple example where we want to demonstrate some Python shenanigans.\nHere's one Python code block.\n"}]},{"type":"element","tagName":"pre","properties":{"className":["src-block"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-python"]},"children":[{"type":"text","value":"x = 30\nprint(x)\n"}]}]},{"type":"element","tagName":"pre","properties":{"className":["fixed-width"]},"children":[{"type":"text","value":"30"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\nThen here's another code block in the same session.\n"}]},{"type":"element","tagName":"pre","properties":{"className":["src-block"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-python"]},"children":[{"type":"text","value":"for i in range(5):\n  x += 5\n  print(x)\n"}]}]},{"type":"element","tagName":"pre","properties":{"className":["fixed-width"]},"children":[{"type":"text","value":"35\n40\n45\n50\n55"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"\nIn certain code where the output can still change (for example, try executing the previous code block again), this may not be the desired behavior.\nTo correct this, simply execute "},{"type":"element","tagName":"code","properties":{"className":["inline-code"]},"children":[{"type":"text","value":"org-babel-execute-buffer"}]},{"type":"text","value":".\n"}]}]},"backlinks":[{"path":"/2020-04-17-21-41-30","title":"Org mode: Babel"}]},"__N_SSG":true}